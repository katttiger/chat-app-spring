MODELLERING

1. KONCEPT

GAMLA ENTITETER:
- users
- messages

NYA ENTITETER
- kommentarer
- profilsida
- taggar

1.2. ATTRIBUT FÖR DE NYA ENTITETERNA
KOMMENTARER
- Id
- Text

PROFILSIDA
- Id
- Bild
- Beskrivning av användaren

TAGGAR
- Id
- Namn

VIDARE: Message-tabellen kommer nu att få en till egenskap i form av taggar:

1. 3. RELATIONER
- USER har relationer till MESSAGES, KOMMENTARER och PROFILSIDA

    -> USER-MESSAGES (1-*)
    -> USER-KOMMENTARER (1-*)
    -> USER-PROFILSIDA (1-1)

- MESSAGES har relationer till USER, KOMMENTARER och TAGGAR

    -> MESSAGES-TAGGAR (*-*)
    -> MESSAGES-USER (*-1)
    -> MESSAGES-KOMMENTARER (1-*)

- KOMMENTARER har relationer till MESSAGES och USERS

    -> KOMMENTARER-MESSAGES (*-1)
    -> KOMMENTARER-USERS (*-1)

- PROFILSIDA har en relation till USER

    -> PROFILSIDA-USER (1-1)

- TAGGAR har relationer till MESSAGES

    -> TAGGAR-MESSAGES (*-*)

1.4. KONTROLL AV MODELLEN

ANVÄNDARE KAN KOMMENTERA MEDDELANDE | JA
MEDDELANDET HAR EN ANVÄNDARE | JA
ANVÄNDARE HAR EN PROFILBILD | JA
EN PROFILBILD ÄR KOPPLAD TILL EN ANVÄNDARE | JA
MEDDELANDEN KAN HA FLERA TAGGAR | JA
ENT TAGG KAN ANVÄNDAS FLERA GÅNGER | JA

---

2. LOGISK MODELL

USER
    user_id (PK)
    username
    password
    messages (FK user_id [1-*] user_id)
    profile (FK profile_id [1-1] user_id)

MESSAGES
    message_id (PK)
    text
    timestamp
    user (FK message_id [*-1] user_id)
    tag (FK message_id [*-*] tag_id)

KOMMENTARER
    comment_id (PK)
    text
    message (FK comment_id [*-1] message_id)
    user (FK comment_id [*-1] user_id)

TAGGAR
    tag_id (PK)
    message (FK tag_id [*-*] message_id)

PROFILSIDA
    profile_id (PK)
    image
    user_description
    user (FK user_id 1-1 profile_id)

TAG-MESSAGE
    tag_id (FK)
    message_id (FK)

---

SQL

CREATE TABLE users (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
user_name VARCHAR(120) NOT NULL,
password VARCHAR(120) NOT NULL,
profile_id BIGINT NOT NULL
CONSTRAINT
    fk_user_profile FOREIGN KEY (profile_id) REFERENCES profile(profile_id)
);

CREATE TABLE profile(
    id BIGINT PRIMARY KEY AUTOINCREMENT,
    image MEDIA NOT NULL,
    user_description VARCHAR(120) NOT NULL,
    user_id,
    CONSTRAINT
    fk_user_profile FOREIGN KEY (user_id) REFERENCES profile(profile_id)
)

CREATE TABLE messages (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
text VARCHAR(255) NOT NULL,
timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
user_id BIGINT NOT NULL,

CONSTRAINT
    fk_message_user FOREIGN KEY (user_id) REFERENCES users(id)
);

CREATE TABLE comments(
id BIGINT PRIMARY KEY AUTO_INCREMENT,
text VARCHAR(255) NOT NULL,
user_id BIGINT NOT NULL,
comment_id BIGINT NOT NULL
CONSTRAINT
    fk_comment_user FOREIGN KEY (user_id) REFERENCES users(id),
    fk_comment_message FOREIGN KEY (comment_id) REFERENCES comment(id)

);

CREATE TABLE tags (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
name VARCHAR(255) NOT NULL,
)

CREATE TABLE tags_message(tag_id INT
message_id INT
PRIMARY KEY (tag_id, message_id),
FOREIGN KEY (tag_id) REFERENCES tags(id)
FOREIGN KET (message_id) REFERENCES messages(id)
)